function coreViewPlusPC(r){var c=this;this.banLogView=[];this.arrLogView=[];this.strCid="";this.zoneId=r.zoneId;this.contentItems=r.data;this.trackI=ADS_CHECKER.getQuery("i");this.domainSite=document.location.href;this.buildCss=function(a){if(""!=a&&"undefined"!=typeof a&&null!=a){var b=document.createElement("style");b.type="text/css";document.getElementsByTagName("head")[0].appendChild(b);b.styleSheet?b.styleSheet.cssText=a:b.appendChild(document.createTextNode(a))}};this.checkArrLocation=function(a,
b){var d=b.split(","),f;for(f in d)if(f==a)return!0;return!1};this.getCookie=function(a){if(0<document.cookie.length){var b=document.cookie.indexOf(a+"=");if(-1!=b)return b=b+a.length+1,a=document.cookie.indexOf(";",b),-1==a&&(a=document.cookie.length),unescape(document.cookie.substring(b,a))}return""};this.getStorage=function(a){a=ADS_CHECKER.getStorage(a).replace(/timestamp_[0-9]+,/gi,"");return a=a.replace(/timestamp_[0-9]+,/gi,"")};this.checkCookie=function(a){return"undefined"!=typeof c.getCookie(a)&&
""!=c.getCookie(a)?c.getCookie(a):null};this.toArray=function(a){var b=[],d;for(d in a)b.push(a[d]);return b};this.filtering=function(){var a=c.toArray(c.contentItems["1"]),b=c.getStorage("__R"),d=c.getStorage("__RC"),f=[],g=[];if(0<a.length)for(var e=0;e<a.length;e++){var k=a[e].l;if(c.checkArrLocation(b,k)||c.checkArrLocation(d,k)||""==k||null==k)(1==a[e].bannertype||2==a[e].bannertype&&0==a[e].hidden_ads_stats)&&f.push(a[e]),3==a[e].bannertype&&0==a[e].hidden_ads_stats&&f.push(a[e]),3==a[e].bannertype&&
1==a[e].hidden_ads_stats&&g.push(a[e])}return{cpc_cpm:f,cpd:g}};this.arrangeItems=function(a){var b=[],d=-1,f=[];if(typeof(numberItem)=='undefined'){numberItem=1;}""!=c.trackI&&(d=Math.floor(Math.random()*(a.length>=numberItem?numberItem:a.length)));if(0<a.length){for(var g=[],e=[],k=0,h=0;h<a.length;h++){var l=a[h];e.push(l.r);f.push(l.bid);g.push(h);k++}for(h=0;h<a.length&&!(k<h);h++){var m=0;l=[0];for(var n=!1,p=0;p<e.length;p++)m+=e[p],l.push(m);p=m*Math.random();if(""!=f&&h===d)for(m=0;m<f.length;m++)c.trackI===f[m]&&(b.push(g[m]),g.splice(m,
1),e.splice(m,1),f.splice(m,1),n=!0);if(!n)for(n=1;n<=e.length;n++)l[n]>p&&l[n-1]<p&&(b.push(g[n-1]),g.splice(n-1,1),e.splice(n-1,1),f.splice(n-1,1))}}d=[];for(p=0;p<b.length;p++)d.push(a[b[p]]);return d};this.setCookieProduct=function(a){var b=[],d="",f="",g=!1,e=!1,k=0,h=c.getStorage("adm_vplus_"+c.zoneId);if(""==h)g=!0;else{var l=h.split(",");for(h=0;h<l.length;h++)-1<l[h].indexOf("cpd")&&k++,-1<l[h].indexOf("_false")?(b.push(l[h]),e=!0):d+=l[h]+","}if(g||!e||k!=a){b=[];for(h=0;3>h;h++)h<a?b.push("cpd_false"):
b.push("cpc_cpm_false");d=""}a=Math.floor(Math.random()*b.length);if(0<b.length){for(h=0;h<b.length;h++)h===a?(f=b[h].replace("_false",""),d+=b[h].replace("_false","_true")+","):d+=b[h]+",";ADS_CHECKER.setStorage("adm_vplus_"+c.zoneId,d.slice(0,-1),"","/")}return f};this.checkCpd=function(a){for(var b=[],d=c.getStorage("adm_cpd_vplus_"+c.zoneId).split(","),f=0;f<a.length;f++){var g=!1;if(""!=c.getStorage("adm_cpd_vplus_"+c.zoneId)&&0<d.length)for(var e=0;e<d.length;e++)if(d[e]===a[f].bid){g=!0;break}g||
b.push(a[f])}0===b.length&&(b=a);return b};this.setCookieBanner=function(a){var b=c.getStorage("adm_cpd_vplus_"+c.zoneId);if(""==b)ADS_CHECKER.setStorage("adm_cpd_vplus_"+c.zoneId,a,"","/");else{var d=b.split(","),f=!1;if(""!=a){for(var g=0;g<d.length;g++)if(d[g]===a){f=!0;break}f?ADS_CHECKER.setStorage("adm_cpd_vplus_"+c.zoneId,a,"","/"):ADS_CHECKER.setStorage("adm_cpd_vplus_"+c.zoneId,b+","+a,"","/")}}};this.dataItem=function(){var a=c.filtering(),b=[],d=0;if("undefined"!=typeof a&&null!=a&&""!=
a&&"object"===typeof a){if(0<a.cpd.length){if(3<a.cpd.length||0===a.cpc_cpm)b=c.checkCpd(a.cpd),d=3;if(1<=a.cpd.length){var f=c.setCookieProduct(a.cpd.length);"afamily.vn"==document.domain&&(f="cpd");"cpd"===f&&(b=c.checkCpd(a.cpd),d=3);"cpc_cpm"===f&&(b=c.arrangeItems(a.cpc_cpm),d=12)}}0<a.cpc_cpm.length&&0===a.cpd.length&&(b=c.arrangeItems(a.cpc_cpm),d=12)}return{data:b,type:d}};this.getSubString=function(a,b){var d=a;if(a.length>b){d=a.substr(0,b-4);var f=d.lastIndexOf(" ");d=d.substr(0,f);d+=
"..."}return d};this.getUrlVplus=function(a){var b="//lg1.logging.admicro.vn";try{"undefined"!=typeof admerrorload&&1==parent.admerrorload&&(b="//trunkpkg.com")}catch(g){}c.strCid+=a.cid+",";var d=b+"/adn?pt=sp&pr="+a.pr+"&items="+a.bid+"&dmn="+encodeURIComponent(c.domainSite)+__AdmsendRandom+"&zid="+c.zoneId+"&cmpg="+a.cid+"&cid=-1&tpn=18&tp="+(2==a.is_view?12:11),f="";try{f=a.tracking_view||""}catch(g){}c.arrLogView.push({logview:d,link3rd:f,check:!1});return b+"/adn?pt=sp&cov=1&pr="+a.pr+"&items="+
a.bid+"&dmn="+encodeURIComponent(c.domainSite)+__AdmsendRandom+"&zid="+c.zoneId+"&cmpg="+a.cid+"&cid=-1&re="+encodeURIComponent(a.link)+"&tpn=18&tp="+(2==a.is_view?12:11)};this.getNumberView=function(a){try{if(""!=c.strCid){var b=c.strCid.substring(0,c.strCid.length-1);if(window.XMLHttpRequest){var d=new XMLHttpRequest;d.onreadystatechange=function(){if(4==d.readyState&&200==d.status)for(var b=JSON.parse(d.responseText),g=b.length,e=0;e<g;e++){var k=a+"_"+c.zoneId+"_"+e;c.setNumberViewBanner(parseInt(b[e].view),
k)}};d.open("GET","//pson.logging.admicro.vn/psmc?i="+b+"&z=v1",!0);d.send()}}}catch(f){}};c.setNumberViewBanner=function(a,b){if(1<a/1E6){var d=Math.floor(a/1E6);var c=a%1E6;c=0<c?","+c.toString().substring(0,1):"";d="+"+d+(""!=c?c:"")+"M"}else 1<a/1E3?(d=Math.floor(a/1E3),c=a%1E3,c=0<c?","+c.toString().substring(0,1):"",d="+"+d+(""!=c?c:"")+"K"):d="+"+a;try{var g=document.getElementById(b);g&&(g.innerHTML=d)}catch(e){}};var q=function(a){(new Image).src=a};this.loadJs=function(a,b){var c=document.createElement("script");
document.getElementsByTagName("head")[0].appendChild(c);c.onload=function(){"function"==typeof b&&b();b=null};c.onreadystatechange=function(){if(4==c.readyState||"complete"==c.readyState)"function"==typeof b&&b(),b=null};c.src=a};this.sendLogView=function(a,b){var d=function(){if("object"==typeof c.arrLogView)if("undefined"!=typeof b&&""!=b&&null!=b&&b)for(var d={i:0};d.i<c.arrLogView.length;d={i:d.i},d.i++)try{var g=document.getElementById(a+"_"+d.i);g&&(window["visibility_"+a+"_"+d.i]=VisSense(g,
{fullyvisible:.5}).monitor({fullyvisible:function(b){return function(){c.arrLogView[b.i].check||(q(c.arrLogView[b.i].logview),""!=c.arrLogView[b.i].link3rd&&q(c.arrLogView[b.i].link3rd),c.arrLogView[b.i].check=!0);window["visibility_"+a+"_"+b.i].stop()}}(d)}).start())}catch(e){}else try{(g=document.getElementById(a))&&(window["visibility_"+a]=VisSense(g,{fullyvisible:.5}).monitor({fullyvisible:function(){for(var b=0;b<c.arrLogView.length;b++)c.arrLogView[b].check||(q(c.arrLogView[b].logview),""!=
c.arrLogView[b].link3rd&&q(c.arrLogView[b].link3rd),c.arrLogView[b].check=!0);window["visibility_"+a].stop()}}).start())}catch(e){}};"function"==typeof VisSense?d():c.loadJs("https://adi.admicro.vn/adt/banners/nam2015/4699/library/vissense.min.js",function(){d()})}};